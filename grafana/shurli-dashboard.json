{
  "__inputs": [
    {
      "name": "DS_PROMETHEUS",
      "label": "Prometheus",
      "description": "Prometheus data source pointing at shurli's /metrics endpoint",
      "type": "datasource",
      "pluginId": "prometheus",
      "pluginName": "Prometheus"
    }
  ],
  "__requires": [
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "10.0.0"
    },
    {
      "type": "datasource",
      "id": "prometheus",
      "name": "Prometheus",
      "version": "1.0.0"
    },
    {
      "type": "panel",
      "id": "stat",
      "name": "Stat",
      "version": ""
    },
    {
      "type": "panel",
      "id": "timeseries",
      "name": "Time series",
      "version": ""
    },
    {
      "type": "panel",
      "id": "gauge",
      "name": "Gauge",
      "version": ""
    },
    {
      "type": "panel",
      "id": "table",
      "name": "Table",
      "version": ""
    },
    {
      "type": "panel",
      "id": "barchart",
      "name": "Bar chart",
      "version": ""
    }
  ],
  "annotations": {
    "list": []
  },
  "description": "Monitoring dashboard for Shurli P2P networking. Covers proxy throughput, auth decisions, vault seal state, unseal attempts, pairing, invite deposits, admin socket, hole punch stats, daemon API latency, and system metrics.",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "id": 100,
      "title": "Overview",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }] },
          "mappings": []
        }
      },
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 1 },
      "id": 1,
      "options": { "colorMode": "value", "graphMode": "none", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Version",
      "type": "stat",
      "targets": [
        {
          "expr": "shurli_info",
          "legendFormat": "{{version}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }] },
          "unit": "s",
          "mappings": []
        }
      },
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 1 },
      "id": 2,
      "options": { "colorMode": "value", "graphMode": "none", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Uptime",
      "type": "stat",
      "targets": [
        {
          "expr": "process_start_time_seconds",
          "legendFormat": "",
          "refId": "A",
          "instant": true
        }
      ],
      "transformations": [
        {
          "id": "calculateField",
          "options": {
            "mode": "binary",
            "reduce": { "reducer": "lastNotNull" },
            "binary": { "left": "Time", "operator": "-", "right": "Value" }
          }
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 10 }, { "color": "red", "value": 20 }] },
          "mappings": []
        }
      },
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 1 },
      "id": 3,
      "options": { "colorMode": "value", "graphMode": "area", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Active Proxy Connections",
      "type": "stat",
      "targets": [
        {
          "expr": "sum(shurli_proxy_active_connections)",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }] },
          "mappings": []
        }
      },
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 1 },
      "id": 4,
      "options": { "colorMode": "value", "graphMode": "area", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Total Connections",
      "type": "stat",
      "targets": [
        {
          "expr": "sum(shurli_proxy_connections_total)",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }] },
          "unit": "decbytes",
          "mappings": []
        }
      },
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 1 },
      "id": 5,
      "options": { "colorMode": "value", "graphMode": "area", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Total Bytes Transferred",
      "type": "stat",
      "targets": [
        {
          "expr": "sum(shurli_proxy_bytes_total)",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "red", "value": null }, { "color": "green", "value": 1 }] },
          "mappings": [
            { "options": { "0": { "text": "Denied", "color": "red" }, "1": { "text": "Allowed", "color": "green" } }, "type": "value" }
          ]
        }
      },
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 1 },
      "id": 6,
      "options": { "colorMode": "background", "graphMode": "none", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Auth Allow / Deny",
      "type": "stat",
      "targets": [
        {
          "expr": "sum(shurli_auth_decisions_total{decision=\"allow\"})",
          "legendFormat": "Allow",
          "refId": "A"
        },
        {
          "expr": "sum(shurli_auth_decisions_total{decision=\"deny\"})",
          "legendFormat": "Deny",
          "refId": "B"
        }
      ]
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 5 },
      "id": 101,
      "title": "Proxy Throughput",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never", "axisLabel": "" },
          "unit": "Bps",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 6 },
      "id": 10,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "lastNotNull"] }, "tooltip": { "mode": "multi" } },
      "title": "Proxy Throughput (bytes/sec)",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(shurli_proxy_bytes_total{direction=\"in\"}[$__rate_interval])",
          "legendFormat": "{{service}} (in)",
          "refId": "A"
        },
        {
          "expr": "rate(shurli_proxy_bytes_total{direction=\"out\"}[$__rate_interval])",
          "legendFormat": "{{service}} (out)",
          "refId": "B"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 6 },
      "id": 11,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "lastNotNull"] }, "tooltip": { "mode": "multi" } },
      "title": "Active Connections by Service",
      "type": "timeseries",
      "targets": [
        {
          "expr": "shurli_proxy_active_connections",
          "legendFormat": "{{service}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "ops",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 14 },
      "id": 12,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "lastNotNull"] }, "tooltip": { "mode": "multi" } },
      "title": "Connection Rate (per second)",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(shurli_proxy_connections_total[$__rate_interval])",
          "legendFormat": "{{service}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "s",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 14 },
      "id": 13,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "lastNotNull"] }, "tooltip": { "mode": "multi" } },
      "title": "Connection Duration (p50 / p95 / p99)",
      "type": "timeseries",
      "targets": [
        {
          "expr": "histogram_quantile(0.50, rate(shurli_proxy_duration_seconds_bucket[$__rate_interval]))",
          "legendFormat": "p50 {{service}}",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.95, rate(shurli_proxy_duration_seconds_bucket[$__rate_interval]))",
          "legendFormat": "p95 {{service}}",
          "refId": "B"
        },
        {
          "expr": "histogram_quantile(0.99, rate(shurli_proxy_duration_seconds_bucket[$__rate_interval]))",
          "legendFormat": "p99 {{service}}",
          "refId": "C"
        }
      ]
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 22 },
      "id": 102,
      "title": "Security",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "ops",
          "mappings": []
        },
        "overrides": [
          { "matcher": { "id": "byName", "options": "deny" }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] },
          { "matcher": { "id": "byName", "options": "allow" }, "properties": [{ "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }] }
        ]
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 23 },
      "id": 20,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["sum", "lastNotNull"] }, "tooltip": { "mode": "multi" } },
      "title": "Auth Decisions Rate",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(shurli_auth_decisions_total[$__rate_interval])",
          "legendFormat": "{{decision}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }, { "color": "orange", "value": 5 }, { "color": "red", "value": 20 }] },
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 23 },
      "id": 21,
      "options": { "colorMode": "value", "graphMode": "area", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Auth Decisions (Cumulative)",
      "type": "stat",
      "targets": [
        {
          "expr": "sum(shurli_auth_decisions_total{decision=\"allow\"})",
          "legendFormat": "Allowed",
          "refId": "A"
        },
        {
          "expr": "sum(shurli_auth_decisions_total{decision=\"deny\"})",
          "legendFormat": "Denied",
          "refId": "B"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "ops",
          "mappings": []
        },
        "overrides": [
          { "matcher": { "id": "byName", "options": "success" }, "properties": [{ "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }] },
          { "matcher": { "id": "byName", "options": "failure" }, "properties": [{ "id": "color", "value": { "fixedColor": "orange", "mode": "fixed" } }] },
          { "matcher": { "id": "byName", "options": "denied" }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] },
          { "matcher": { "id": "byName", "options": "blocked" }, "properties": [{ "id": "color", "value": { "fixedColor": "dark-red", "mode": "fixed" } }] },
          { "matcher": { "id": "byName", "options": "locked_out" }, "properties": [{ "id": "color", "value": { "fixedColor": "yellow", "mode": "fixed" } }] }
        ]
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 31 },
      "id": 60,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["sum", "lastNotNull"] }, "tooltip": { "mode": "multi" } },
      "title": "Vault Unseal Attempts",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(shurli_vault_unseal_total[$__rate_interval])",
          "legendFormat": "{{result}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }, { "color": "orange", "value": 1 }, { "color": "red", "value": 3 }] },
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 31 },
      "id": 61,
      "options": { "colorMode": "value", "graphMode": "area", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Locked/Blocked Peers (Unseal)",
      "type": "stat",
      "targets": [
        {
          "expr": "shurli_vault_unseal_locked_peers",
          "legendFormat": "Locked peers",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }, { "color": "orange", "value": 1 }] },
          "mappings": [
            { "options": { "0": { "text": "UNSEALED", "color": "green" }, "1": { "text": "SEALED", "color": "orange" } }, "type": "value" }
          ]
        }
      },
      "gridPos": { "h": 8, "w": 6, "x": 0, "y": 39 },
      "id": 62,
      "options": { "colorMode": "background", "graphMode": "none", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Vault Seal State",
      "type": "stat",
      "targets": [
        {
          "expr": "shurli_vault_sealed",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "ops",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 6, "x": 6, "y": 39 },
      "id": 63,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["sum"] }, "tooltip": { "mode": "multi" } },
      "title": "Vault Seal/Unseal Ops",
      "type": "timeseries",
      "targets": [
        {
          "expr": "increase(shurli_vault_seal_operations_total[$__rate_interval])",
          "legendFormat": "{{trigger}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "ops",
          "mappings": []
        },
        "overrides": [
          { "matcher": { "id": "byName", "options": "success" }, "properties": [{ "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }] },
          { "matcher": { "id": "byName", "options": "failure" }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] }
        ]
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 39 },
      "id": 64,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["sum"] }, "tooltip": { "mode": "multi" } },
      "title": "Pairing Attempts",
      "type": "timeseries",
      "targets": [
        {
          "expr": "increase(shurli_pairing_total[$__rate_interval])",
          "legendFormat": "{{result}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "ops",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 47 },
      "id": 65,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["sum"] }, "tooltip": { "mode": "multi" } },
      "title": "Deposit Operations",
      "type": "timeseries",
      "targets": [
        {
          "expr": "increase(shurli_deposit_operations_total[$__rate_interval])",
          "legendFormat": "{{operation}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 5 }, { "color": "orange", "value": 10 }] },
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 4, "x": 8, "y": 47 },
      "id": 66,
      "options": { "colorMode": "value", "graphMode": "area", "textMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Pending Deposits",
      "type": "stat",
      "targets": [
        {
          "expr": "shurli_deposit_pending",
          "legendFormat": "Pending",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "reqps",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 47 },
      "id": 67,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["sum"] }, "tooltip": { "mode": "multi" } },
      "title": "Admin Socket Requests",
      "type": "timeseries",
      "targets": [
        {
          "expr": "sum by (endpoint) (rate(shurli_admin_request_total[$__rate_interval]))",
          "legendFormat": "{{endpoint}}",
          "refId": "A"
        }
      ]
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 55 },
      "id": 103,
      "title": "Hole Punch (NAT Traversal)",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "auto" },
          "mappings": []
        },
        "overrides": [
          { "matcher": { "id": "byName", "options": "success" }, "properties": [{ "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }] },
          { "matcher": { "id": "byName", "options": "failure" }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] }
        ]
      },
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 56 },
      "id": 30,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["sum"] }, "tooltip": { "mode": "multi" } },
      "title": "Hole Punch Attempts",
      "type": "timeseries",
      "targets": [
        {
          "expr": "increase(shurli_holepunch_total[$__rate_interval])",
          "legendFormat": "{{result}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "red", "value": null }, { "color": "orange", "value": 50 }, { "color": "green", "value": 70 }] },
          "unit": "percentunit",
          "min": 0,
          "max": 1,
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 56 },
      "id": 31,
      "options": { "showThresholdLabels": false, "showThresholdMarkers": true, "reduceOptions": { "calcs": ["lastNotNull"] } },
      "title": "Hole Punch Success Rate",
      "type": "gauge",
      "targets": [
        {
          "expr": "sum(shurli_holepunch_total{result=\"success\"}) / sum(shurli_holepunch_total)",
          "legendFormat": "",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "s",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 56 },
      "id": 32,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] }, "tooltip": { "mode": "multi" } },
      "title": "Hole Punch Duration",
      "type": "timeseries",
      "targets": [
        {
          "expr": "histogram_quantile(0.50, rate(shurli_holepunch_duration_seconds_bucket[$__rate_interval]))",
          "legendFormat": "p50",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.95, rate(shurli_holepunch_duration_seconds_bucket[$__rate_interval]))",
          "legendFormat": "p95",
          "refId": "B"
        }
      ]
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 64 },
      "id": 104,
      "title": "Daemon API",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "reqps",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 65 },
      "id": 40,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "sum"] }, "tooltip": { "mode": "multi" } },
      "title": "API Request Rate",
      "type": "timeseries",
      "targets": [
        {
          "expr": "sum by (path) (rate(shurli_daemon_requests_total[$__rate_interval]))",
          "legendFormat": "{{path}}",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "s",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 65 },
      "id": 41,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] }, "tooltip": { "mode": "multi" } },
      "title": "API Request Latency (p50 / p95)",
      "type": "timeseries",
      "targets": [
        {
          "expr": "histogram_quantile(0.50, sum by (le, path) (rate(shurli_daemon_request_duration_seconds_bucket[$__rate_interval])))",
          "legendFormat": "p50 {{path}}",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.95, sum by (le, path) (rate(shurli_daemon_request_duration_seconds_bucket[$__rate_interval])))",
          "legendFormat": "p95 {{path}}",
          "refId": "B"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "reqps",
          "mappings": []
        },
        "overrides": [
          { "matcher": { "id": "byRegexp", "options": ".*4.." }, "properties": [{ "id": "color", "value": { "fixedColor": "orange", "mode": "fixed" } }] },
          { "matcher": { "id": "byRegexp", "options": ".*5.." }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] }
        ]
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 73 },
      "id": 42,
      "options": { "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["sum"] }, "tooltip": { "mode": "multi" } },
      "title": "API Requests by Status Code",
      "type": "timeseries",
      "targets": [
        {
          "expr": "sum by (status) (rate(shurli_daemon_requests_total[$__rate_interval]))",
          "legendFormat": "{{status}}",
          "refId": "A"
        }
      ]
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 81 },
      "id": 105,
      "title": "System (Go Runtime)",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "decbytes",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 82 },
      "id": 50,
      "options": { "legend": { "displayMode": "list", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "title": "Memory Usage",
      "type": "timeseries",
      "targets": [
        {
          "expr": "go_memstats_alloc_bytes",
          "legendFormat": "Heap In-Use",
          "refId": "A"
        },
        {
          "expr": "go_memstats_sys_bytes",
          "legendFormat": "System",
          "refId": "B"
        },
        {
          "expr": "process_resident_memory_bytes",
          "legendFormat": "RSS",
          "refId": "C"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 82 },
      "id": 51,
      "options": { "legend": { "displayMode": "list", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "title": "Goroutines",
      "type": "timeseries",
      "targets": [
        {
          "expr": "go_goroutines",
          "legendFormat": "Goroutines",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "unit": "ops",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 82 },
      "id": 52,
      "options": { "legend": { "displayMode": "list", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "title": "GC Rate",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(go_gc_duration_seconds_count[$__rate_interval])",
          "legendFormat": "GC cycles/sec",
          "refId": "A"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 10, "showPoints": "never" },
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 90 },
      "id": 53,
      "options": { "legend": { "displayMode": "list", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "title": "Open File Descriptors",
      "type": "timeseries",
      "targets": [
        {
          "expr": "process_open_fds",
          "legendFormat": "Open FDs",
          "refId": "A"
        },
        {
          "expr": "process_max_fds",
          "legendFormat": "Max FDs",
          "refId": "B"
        }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "lineWidth": 2, "fillOpacity": 10, "showPoints": "never" },
          "unit": "percentunit",
          "mappings": []
        }
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 90 },
      "id": 54,
      "options": { "legend": { "displayMode": "list", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "title": "CPU Usage",
      "type": "timeseries",
      "targets": [
        {
          "expr": "rate(process_cpu_seconds_total[$__rate_interval])",
          "legendFormat": "CPU",
          "refId": "A"
        }
      ]
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "tags": ["shurli", "p2p", "networking"],
  "templating": { "list": [] },
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {},
  "timezone": "browser",
  "title": "Shurli",
  "uid": "shurli-overview",
  "version": 1
}
