<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450" width="800" height="450">
  <defs>
    <linearGradient id="nodeFill" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2c2a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1e1d20;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="relayFill" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#38353b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2a282c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="internetFill" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1e1d20;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1e1d20;stop-opacity:1" />
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="800" height="450" rx="12" fill="#141316"/>

  <!-- Internet cloud bar -->
  <rect x="100" y="20" width="600" height="40" rx="8" fill="url(#internetFill)" stroke="#565f89" stroke-width="1" opacity="0.6"/>
  <text x="400" y="45" font-family="system-ui, sans-serif" font-size="12" fill="#565f89" text-anchor="middle" font-weight="600">Internet</text>

  <!-- Vertical lines from Internet to Relay and Client -->
  <line x1="400" y1="60" x2="400" y2="110" stroke="#565f89" stroke-width="1" stroke-dasharray="4,3" opacity="0.4"/>
  <line x1="160" y1="60" x2="160" y2="170" stroke="#565f89" stroke-width="1" stroke-dasharray="4,3" opacity="0.4"/>

  <!-- Relay connections (solid blue - always works) -->
  <line x1="185" y1="225" x2="345" y2="160" stroke="#e8729a" stroke-width="2.5" filter="url(#glow)"/>
  <line x1="455" y1="160" x2="605" y2="225" stroke="#e8729a" stroke-width="2.5" filter="url(#glow)"/>

  <!-- Direct connection (dashed green - when hole-punch succeeds) -->
  <line x1="185" y1="240" x2="605" y2="240" stroke="#9ece6a" stroke-width="2" stroke-dasharray="8,6" opacity="0.5"/>

  <!-- DCUtR upgrade label -->
  <text x="400" y="265" font-family="system-ui, sans-serif" font-size="10" fill="#9ece6a" text-anchor="middle" opacity="0.7">DCUtR hole-punch upgrade</text>

  <!-- Relay Server (center top) -->
  <rect x="330" y="110" width="140" height="80" rx="12" fill="url(#relayFill)" stroke="#bb9af7" stroke-width="1.5"/>
  <!-- Cloud icon -->
  <ellipse cx="400" cy="132" rx="20" ry="12" fill="none" stroke="#bb9af7" stroke-width="1.5"/>
  <ellipse cx="390" cy="135" rx="10" ry="7" fill="#2a282c"/>
  <ellipse cx="410" cy="135" rx="10" ry="7" fill="#2a282c"/>
  <text x="400" y="160" font-family="system-ui, sans-serif" font-size="13" fill="#c0caf5" text-anchor="middle" font-weight="600">Relay Server</text>
  <text x="400" y="175" font-family="SF Mono, monospace" font-size="10" fill="#565f89" text-anchor="middle">VPS · Public IP</text>

  <!-- Client Node (left) -->
  <rect x="60" y="195" width="200" height="90" rx="12" fill="url(#nodeFill)" stroke="#da1c5c" stroke-width="1.5"/>
  <!-- Phone icon -->
  <rect x="140" y="207" width="20" height="32" rx="4" fill="none" stroke="#e8729a" stroke-width="1.3"/>
  <line x1="146" y1="232" x2="154" y2="232" stroke="#e8729a" stroke-width="1.2"/>
  <text x="160" y="258" font-family="system-ui, sans-serif" font-size="13" fill="#c0caf5" text-anchor="middle" font-weight="600">Client Node</text>
  <text x="160" y="273" font-family="SF Mono, monospace" font-size="10" fill="#565f89" text-anchor="middle">Phone / Laptop · CGNAT</text>

  <!-- Home Node (right) -->
  <rect x="540" y="195" width="200" height="90" rx="12" fill="url(#nodeFill)" stroke="#da1c5c" stroke-width="1.5"/>
  <!-- Server icon -->
  <rect x="625" y="207" width="30" height="8" rx="2" fill="none" stroke="#e8729a" stroke-width="1.2"/>
  <rect x="625" y="217" width="30" height="8" rx="2" fill="none" stroke="#e8729a" stroke-width="1.2"/>
  <rect x="625" y="227" width="30" height="8" rx="2" fill="none" stroke="#e8729a" stroke-width="1.2"/>
  <circle cx="650" cy="211" r="1.5" fill="#9ece6a"/>
  <circle cx="650" cy="221" r="1.5" fill="#9ece6a"/>
  <circle cx="650" cy="231" r="1.5" fill="#9ece6a"/>
  <text x="640" y="258" font-family="system-ui, sans-serif" font-size="13" fill="#c0caf5" text-anchor="middle" font-weight="600">Home Node</text>
  <text x="640" y="273" font-family="SF Mono, monospace" font-size="10" fill="#565f89" text-anchor="middle">CGNAT + IPv6 · Firewall</text>

  <!-- NAT walls -->
  <rect x="245" y="190" width="4" height="100" rx="2" fill="#f7768e" opacity="0.4"/>
  <text x="247" y="186" font-family="SF Mono, monospace" font-size="9" fill="#f7768e" text-anchor="middle" opacity="0.6">NAT</text>
  <rect x="551" y="190" width="4" height="100" rx="2" fill="#f7768e" opacity="0.4"/>
  <text x="553" y="186" font-family="SF Mono, monospace" font-size="9" fill="#f7768e" text-anchor="middle" opacity="0.6">NAT</text>

  <!-- Connection flow steps -->
  <text x="400" y="320" font-family="system-ui, sans-serif" font-size="12" fill="#c0caf5" text-anchor="middle" font-weight="600">Connection Flow</text>

  <text x="80" y="345" font-family="SF Mono, monospace" font-size="10" fill="#a9b1d6">
    <tspan fill="#bb9af7">1.</tspan> Home → Relay: reserve slot (outbound)
  </text>
  <text x="80" y="363" font-family="SF Mono, monospace" font-size="10" fill="#a9b1d6">
    <tspan fill="#bb9af7">2.</tspan> Client → Relay: connect (outbound)
  </text>
  <text x="80" y="381" font-family="SF Mono, monospace" font-size="10" fill="#a9b1d6">
    <tspan fill="#bb9af7">3.</tspan> Client dials Home via /p2p-circuit
  </text>
  <text x="430" y="345" font-family="SF Mono, monospace" font-size="10" fill="#a9b1d6">
    <tspan fill="#bb9af7">4.</tspan> Relay bridges connection (both outbound)
  </text>
  <text x="430" y="363" font-family="SF Mono, monospace" font-size="10" fill="#a9b1d6">
    <tspan fill="#bb9af7">5.</tspan> DCUtR attempts hole-punch for direct
  </text>

  <!-- Legend -->
  <line x1="120" y1="420" x2="160" y2="420" stroke="#e8729a" stroke-width="2.5"/>
  <text x="170" y="424" font-family="system-ui, sans-serif" font-size="11" fill="#a9b1d6">Encrypted relay path</text>
  <line x1="340" y1="420" x2="380" y2="420" stroke="#9ece6a" stroke-width="2" stroke-dasharray="8,6"/>
  <text x="390" y="424" font-family="system-ui, sans-serif" font-size="11" fill="#a9b1d6">Direct P2P (hole-punched)</text>
  <rect x="570" y="414" width="12" height="12" rx="2" fill="#f7768e" opacity="0.4"/>
  <text x="590" y="424" font-family="system-ui, sans-serif" font-size="11" fill="#a9b1d6">NAT / Firewall</text>
</svg>
